<!DOCTYPE html>
<html class="dark" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>AIGO Security Monitor - Compliance Codex</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script defer="" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#22D3EE",
                        "success": "#22C55E",
                        "primary-dim": "rgba(34, 211, 238, 0.14)",
                        "background-dark": "#050914",
                        "surface-dark": "#101C34",
                        "border-dark": "#24385B",
                        "critical": "#EF4444",
                        "warning": "#FACC15",
                        "text-main": "#E6F4FF",
                        "text-muted": "#7F95B5",
                    },
                    fontFamily: {
                        "display": ["JetBrains Mono", "monospace"],
                        "mono": ["JetBrains Mono", "monospace"],
                        "body": ["Space Grotesk", "monospace"]
                    },
                    borderRadius: {"DEFAULT": "0px", "sm": "0px", "md": "0px", "lg": "0px"},
                    boxShadow: {
                        "glow": "0 0 12px rgba(34, 211, 238, 0.42)",
                        "glow-critical": "0 0 10px rgba(239, 68, 68, 0.4)"
                    }
                },
            },
        }
    </script>
<style>
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #101C34; 
        }
        ::-webkit-scrollbar-thumb {
            background: #24385B; 
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #22D3EE; 
        }
        .bg-grid-pattern {
            background-size: 20px 20px;
            background-image: radial-gradient(circle, #24385B 1px, transparent 1px);
        }
        .border-neon {
            box-shadow: inset 3px 0 0 0 #22D3EE;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        .animate-blink {
            animation: blink 1s step-end infinite;
        }
        .future-aurora {
            position: fixed;
            top: -10rem;
            right: -8rem;
            width: 34rem;
            height: 34rem;
            border-radius: 9999px;
            background: radial-gradient(circle at 28% 30%, rgba(34, 211, 238, 0.24), rgba(59, 130, 246, 0.16) 45%, rgba(5, 9, 20, 0) 72%);
            pointer-events: none;
            z-index: 0;
            filter: blur(2px);
            animation: aurora-drift 18s ease-in-out infinite alternate;
        }
        .future-aurora::after {
            content: "";
            position: absolute;
            top: 20%;
            right: 18%;
            width: 14rem;
            height: 14rem;
            border: 1px solid rgba(103, 232, 249, 0.35);
            border-radius: 9999px;
            animation: pulse-ring 4s ease-out infinite;
        }
        @keyframes aurora-drift {
            0% { transform: translate3d(0, 0, 0) scale(1); opacity: 0.5; }
            50% { transform: translate3d(-36px, 24px, 0) scale(1.08); opacity: 0.72; }
            100% { transform: translate3d(-70px, -18px, 0) scale(1); opacity: 0.48; }
        }
        @keyframes pulse-ring {
            0% { transform: scale(0.72); opacity: 0.6; }
            100% { transform: scale(1.7); opacity: 0; }
        }
        .footer-ticker-viewport {
            position: relative;
            overflow: hidden;
        }
        .footer-ticker-track {
            display: inline-flex;
            align-items: center;
            gap: 2rem;
            min-width: max-content;
            padding-left: 100%;
            animation: footer-ticker-scroll 42s linear infinite;
        }
        .footer-ticker-track:hover {
            animation-play-state: paused;
        }
        .footer-ticker-group {
            display: inline-flex;
            align-items: center;
            gap: 1.25rem;
            white-space: nowrap;
        }
        .footer-ticker-item {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            font-size: 10px;
            font-family: "JetBrains Mono", monospace;
        }
        .footer-ticker-label {
            color: #7F95B5;
        }
        .footer-ticker-separator {
            color: #24385B;
        }
        @keyframes footer-ticker-scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
    </style>
</head>
<body class="bg-background-dark text-text-main font-body overflow-hidden h-screen flex" data-page="codex">
<div class="future-aurora"></div>
<aside class="w-64 border-r border-border-dark bg-surface-dark flex flex-col relative z-30">
<div class="p-6 border-b border-border-dark bg-black/20">
<h1 class="text-white font-mono font-bold text-lg tracking-tighter mb-1">AIGO Security Monitor</h1>
<div class="flex items-center gap-2">
<span class="relative flex h-2 w-2">
<span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>
<span class="relative inline-flex rounded-full h-2 w-2 bg-primary"></span>
</span>
<span class="text-primary font-mono text-xs font-bold tracking-widest" id="codex-system-status">SYSTEM_STATUS: ONLINE</span>
</div>
<div class="hidden text-[10px] text-text-muted font-mono mt-4 leading-relaxed">
                UPTIME: <span id="codex-uptime">42:19:03</span><br/>
                VERSION: <span id="codex-version">2.4.0_STABLE</span>
            </div>
</div>
<nav class="flex-1 px-3 py-6 space-y-1">
<a class="group flex items-center gap-3 px-3 py-3 border border-transparent text-text-muted hover:text-text-main hover:border-border-dark hover:bg-white/5 transition-all" href="../dashboard/index.html">
<span class="material-symbols-outlined text-lg">dashboard</span>
<span class="font-mono text-xs font-bold uppercase tracking-wider">DASHBOARD</span>
</a>
<a class="group flex items-center gap-3 px-3 py-3 bg-primary-dim border border-primary/40 text-primary transition-all" href="../compliance-codex/index.html">
<span class="material-symbols-outlined text-lg">security</span>
<span class="font-mono text-xs font-bold uppercase tracking-wider">COMPLIANCE CODEX</span>
<div class="ml-auto w-1 h-1 bg-primary"></div>
</a>
<a class="group flex items-center gap-3 px-3 py-3 border border-transparent text-text-muted hover:text-text-main hover:border-border-dark hover:bg-white/5 transition-all" href="../scan-report/index.html">
<span class="material-symbols-outlined text-lg">summarize</span>
<span class="font-mono text-xs font-bold uppercase tracking-wider">SCAN REPORTS</span>
</a>
</nav>
<div class="p-5 border-t border-border-dark bg-black/20">
<div class="flex items-center justify-between mb-6">
<h3 class="text-[10px] font-mono font-bold text-text-muted tracking-widest uppercase">ACTIVE_FRAMEWORKS</h3>
<span class="text-[10px] bg-primary/20 text-primary px-1.5 py-0.5 font-bold font-mono" id="codex-framework-count">04</span>
</div>
<div class="space-y-4" id="codex-framework-list">
<div class="flex items-center justify-between">
<div class="flex items-center gap-3">
<div class="w-1.5 h-1.5 bg-primary rounded-full shadow-glow"></div>
<span class="text-xs font-mono text-white">Pillar I</span>
</div>
<span class="text-[10px] text-text-muted font-mono">ACTIVE</span>
</div>
<div class="flex items-center justify-between">
<div class="flex items-center gap-3">
<div class="w-1.5 h-1.5 bg-primary rounded-full shadow-glow"></div>
<span class="text-xs font-mono text-white">Pillar II</span>
</div>
<span class="text-[10px] text-text-muted font-mono">ACTIVE</span>
</div>
<div class="flex items-center justify-between">
<div class="flex items-center gap-3">
<div class="w-1.5 h-1.5 bg-primary rounded-full shadow-glow"></div>
<span class="text-xs font-mono text-white">Pillar III</span>
</div>
<span class="text-[10px] text-text-muted font-mono">ACTIVE</span>
</div>
<div class="flex items-center justify-between">
<div class="flex items-center gap-3">
<div class="w-1.5 h-1.5 bg-primary rounded-full shadow-glow"></div>
<span class="text-xs font-mono text-white">Pillar IV</span>
</div>
<span class="text-[10px] text-text-muted font-mono">ACTIVE</span>
</div>
</div>
</div>
<div class="p-4 border-t border-border-dark bg-black/40">
<button class="w-full py-2 border border-critical/50 text-critical font-mono text-[10px] font-bold uppercase hover:bg-critical hover:text-black transition-all flex items-center justify-center gap-2">
<span class="material-symbols-outlined text-[14px]">power_settings_new</span>
                Terminate
            </button>
</div>
</aside>
<main class="flex-1 flex flex-col overflow-hidden relative z-10 bg-background-dark">
<div class="absolute inset-0 bg-grid-pattern opacity-10 pointer-events-none z-0"></div>
<header class="h-14 border-b border-border-dark bg-background-dark/95 backdrop-blur-sm flex items-center justify-between px-8 shrink-0 z-20">
<div class="flex items-center gap-4 font-mono text-[10px] tracking-widest uppercase">
<div class="text-primary font-bold">COMPLIANCE CODEX</div>
<span class="hidden" id="codex-selected-framework">ALL PILLARS SELECTED</span>
</div>
<div class="font-mono text-[10px] text-text-muted uppercase">
                REPO: <span class="text-text-main" id="codex-header-repo">neural-net-v2-production</span> // SESSION_ID: <span class="text-primary font-bold tracking-wider" id="codex-session-id">PENDING</span>
</div>
</header>
<div class="flex flex-1 overflow-hidden">
<aside class="w-64 bg-background-dark/50 border-r border-border-dark hidden xl:flex flex-col z-10 shrink-0 backdrop-blur-sm">
<div class="p-4 border-b border-border-dark">
<h3 class="text-xs font-bold text-text-muted tracking-widest mb-1">LIBRARY_INDEX</h3>
</div>
<div class="flex-1 overflow-y-auto p-2 space-y-1" id="codex-library-list">
<div class="px-3 py-4 border border-border-dark bg-background-dark text-[10px] text-text-muted font-mono tracking-wide leading-relaxed">
Select one or more mandate pillars to scope the list.
</div>
</div>
<div class="p-4 border-t border-border-dark bg-[#0D1A2E]">
<div class="flex items-center gap-2 text-xs text-text-muted mb-2">
<span class="material-symbols-outlined text-[14px]">update</span>
<span class="font-mono">MANDATE_SYNC</span>
</div>
<div class="font-mono text-xs text-primary" id="codex-last-sync">SYNCING MANDATES...</div>
</div>
</aside>
<div class="flex-1 flex flex-col relative z-10">
<div class="p-8 pb-4">
<div class="flex flex-col md:flex-row md:items-end justify-between gap-4 mb-8">
<div>
<div class="flex items-center gap-2 text-primary mb-2">
<span class="px-2 py-0.5 border border-primary text-[10px] font-bold font-mono">VIEW_ONLY_RULESET</span>
</div>
<h1 class="text-3xl font-display font-bold text-white tracking-tight mb-2" id="codex-ruleset-title">CORE SECURITY MANDATES</h1>
<p class="text-text-muted max-w-3xl text-sm leading-relaxed font-mono" id="codex-ruleset-description">
                                Read-only mandate and risk view with multi-pillar scope selection.
                            </p>
</div>
<div class="flex flex-col items-end gap-2 shrink-0">
<div class="flex gap-2">
<div class="px-3 py-1 bg-primary/10 border border-primary text-primary text-xs font-bold flex items-center gap-2 font-mono" id="codex-ruleset-status">
<span class="w-1.5 h-1.5 bg-primary rounded-full animate-pulse"></span>
                                    STATUS: VIEW_ONLY
                                </div>
<div class="px-3 py-1 border border-border-dark text-text-muted text-xs font-bold font-mono" id="codex-mandates-count">
                                    LOADING_MANDATES...
                                </div>
</div>
</div>
</div>
<div class="flex gap-4 items-center border-b border-border-dark pb-4">
<div class="relative flex-1 group">
<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
<span class="material-symbols-outlined text-text-muted text-lg">search</span>
</div>
<input class="block w-full bg-surface-dark border border-border-dark text-white py-2 pl-10 pr-4 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary font-mono text-sm placeholder-text-muted/50 transition-all" id="codex-filter-input" placeholder="FILTER_MANDATES_OR_RISKS..." type="text"/>
</div>
<div class="flex gap-2">
<button class="px-3 py-2 bg-surface-dark border border-primary text-primary text-xs font-bold font-mono codex-filter-btn" data-filter="all">ALL</button>
<button class="px-3 py-2 bg-background-dark border border-border-dark text-text-muted hover:text-white hover:border-white transition-colors text-xs font-bold font-mono codex-filter-btn" data-filter="critical">CRITICAL</button>
<button class="px-3 py-2 bg-background-dark border border-border-dark text-text-muted hover:text-white hover:border-white transition-colors text-xs font-bold font-mono codex-filter-btn" data-filter="high">HIGH</button>
<button class="px-3 py-2 bg-background-dark border border-border-dark text-text-muted hover:text-white hover:border-white transition-colors text-xs font-bold font-mono codex-filter-btn" data-filter="medium">MODERATE</button>
</div>
</div>
</div>
<div class="flex-1 overflow-y-auto px-8 pb-20 scroll-smooth">
<div class="max-w-6xl space-y-4" id="codex-mandates-sections">
<div class="border border-primary/40 bg-primary/5 p-5 font-mono text-xs text-primary">
                            LOADING_MANDATES...
</div>
</div>
</div>
</div>
</div>
<footer class="h-8 bg-[#101C34] border-t border-[#24385B] flex items-center overflow-hidden shrink-0">
<div class="px-4 bg-[#EF4444] text-black font-mono text-[10px] font-bold h-full flex items-center shrink-0">
                LIVE_STATUS_TICKER
            </div>
<div class="flex-1 px-3 footer-ticker-viewport">
<div class="footer-ticker-track" id="codex-footer-ticker">
<div class="footer-ticker-group">
<span class="footer-ticker-item"><span class="footer-ticker-label">Repo</span><span class="text-text-main">neural-net-v2-production</span></span>
<span class="footer-ticker-separator">|</span>
<span class="footer-ticker-item"><span class="footer-ticker-label">Ruleset</span><span class="text-primary">View Only</span></span>
<span class="footer-ticker-separator">|</span>
<span class="footer-ticker-item"><span class="footer-ticker-label">Mandates</span><span class="text-text-main">Loading</span></span>
</div>
<div aria-hidden="true" class="footer-ticker-group">
<span class="footer-ticker-item"><span class="footer-ticker-label">Repo</span><span class="text-text-main">neural-net-v2-production</span></span>
<span class="footer-ticker-separator">|</span>
<span class="footer-ticker-item"><span class="footer-ticker-label">Ruleset</span><span class="text-primary">View Only</span></span>
<span class="footer-ticker-separator">|</span>
<span class="footer-ticker-item"><span class="footer-ticker-label">Mandates</span><span class="text-text-main">Loading</span></span>
</div>
</div>
            </div>
</footer>
</main>
<script>
        (function () {
            const DOCX_PATH = "../../assets/policies/ai-security-policy-v5.docx";
            const FALLBACK_POLICY_TEXT = `2.1 Pillar I: Zero-Trust and Least-Privilege Architecture
2.1.1 Authorization and Access Control – Mandate that all AI models and agents must be granted the absolute minimum permissions required to perform their designated tasks, including tools in tool-use (Principle of Least Privilege). The use of broad, standing privileges should be prohibited; access rights must be granular, context-specific, and revoked when no longer needed.
Mitigates:
LLM06 Excessive Agency
ASI01 Agent Goal Hijack
ASI03 Identity and Privilege Abuse
MCP01 Tool Poisoning & Rug Pull Attacks
2.1.2 Secure Credential Management – Mandate that all API keys, tokens, and other credentials used by AI systems must be stored in a secure, managed vault. Hardcoding secrets in agent configurations, code, or system prompts should be prohibited. Where possible, automated credential rotation must be implemented to minimize the window of opportunity for misuse.
Mitigates:
LLM07 System Prompt Leakage
ASI03 Identity and Privilege Abuse
2.1.3 Segregation from Critical Systems – Mandate that AI agents and MCP servers must be isolated in a controlled, sandboxed environment with no direct, unmediated access to high-stakes systems such as financial platforms, healthcare databases, or industrial control systems. All interactions with such systems must occur through hardened, monitored, and rate-limited APIs that enforce strict constraints.
Mitigates:
LLM06 Excessive Agency
ASI02 Tool Misuse and Exploitation
ASI05 Unexpected Code Execution (RCE)
MCP05 Client Security Considerations
MCP06 Server Discovery and Verification
2.1.4 Sensitive Data Handling in Training Data and System Prompts – Mandate the implementation of data sanitization techniques to prevent sensitive data (e.g. PII, financial details, health records) from entering training models or being exposed in logs. The inclusion of sensitive information like credentials, proprietary algorithms, or confidential business data in system prompts is strictly prohibited.
Mitigates:
ML03 Model Inversion Attack
ML04 Membership Inference Attack
LLM02 Sensitive Information Disclosure
LLM07 System Prompt Leakage
ASI03 Identity and Privilege Abuse
ASI06: Memory & Context Poisoning
2.1.5 Just-in-Time (JIT) and Identity-Based MCP Authentication – Mandate that all connections to remote MCP servers utilize OAuth 2.1 (with OIDC/PKCE for user-driven tasks) to ensure robust authentication. Permissions must be granted on a Just-in-Time (JIT) basis, providing narrowly scoped access only for the duration of a specific task with instant revocation upon completion
Mitigates:
ASI03 Identity and Privilege Abuse
MCP05 Client Security Considerations
MCP06 Server Discovery and Verification
2.2 Pillar II: Data and Model Integrity Across the Lifecycle
2.2.1 AI Supply Chain Security – Mandate that all third-party components—including pre-trained models, libraries, plugins, datasets, and other third-party AI services (e.g. MCP servers)—must be sourced from reputable, secure providers. All third-party dependencies must be tracked in a detailed inventory, such as an Software / AI Bill of Materials (SBOM / AIBOM), and subjected to automated scanning for known vulnerabilities before and during use.
Mitigates:
ML06 AI Supply Chain Attacks
LLM03 Supply Chain
ASI04 Agentic Supply Chain Vulnerabilities
MCP06 Server Discovery and Verification
2.2.2 Prevention of Data and Model Poisoning – Mandate rigorous vetting and validation of all data sources used for training, fine-tuning, or Retrieval-Augmented Generation (RAG). Data validation pipelines and anomaly detection techniques must be implemented to filter adversarial or malicious content designed to introduce biases, backdoors, or vulnerabilities into the model.
Mitigates:
ML02 Data Poisoning Attack
ML08 Model Skewing
LLM04 Data and Model Poisoning
ASI06 Memory & Context Poisoning
MCP03 Memory Poisoning
2.2.3 Secure Training and Fine-Tuning – Mandate that training data must be logically and physically separated from production data, with strict access controls to prevent contamination. When using transfer learning, only secure and trusted pre-trained models and datasets from verified sources may be used for fine-tuning.
Mitigates:
ML02 Data Poisoning Attack
ML07 Transfer Learning Attack
LLM04 Data and Model Poisoning
2.2.4 Vector Database and Embedding Security – Mandate strict logical and access partitioning of datasets in multi-tenant environments utilizing a shared vector database. This is critical to prevent cross-context information leakage where one user's query could inadvertently retrieve sensitive data from another tenant's embeddings.
Mitigates:
LLM08 Vector and Embedding Weaknesses
ASI06 Memory & Context Poisoning
MCP03 Memory Poisoning
2.2.5 Model Asset Protection – Mandate the implementation of technical controls to prevent the unauthorized access to, or theft of, proprietary model parameters, architecture, and code. Such controls must include strong access control, encryption of model assets at rest and in transit, and where appropriate, obfuscation techniques.
Mitigates:
ML05 Model Theft ML10 Model Poisoning
ML03 Model Inversion Attack
LLM10 Unbounded Consumption
2.2.6 MCP Registry and Tool Integrity Pinning – If MCP servers are in use, establish a Central Trusted MCP Registry. All third-party tools must be version-pinned using cryptographic hashes or checksums of their manifests (descriptions, parameters, and code) to ensure they have not been maliciously altered post-approval
Mitigates:
ASI02 Tool Misuse and Exploitation
ASI04 Agentic Supply Chain Vulnerabilities
MCP01 Tool Poisoning & Rug Pull Attack
2.3 Pillar III: Continuous Monitoring and Human-in-the-Loop Oversight
2.3.1 Comprehensive Logging and Auditing – Mandate that all actions performed by AI systems, particularly those involving access to sensitive systems, modification of data, or communication with external services, must be continuously logged and audited. Logs must be stored in an immutable format to create a clear, tamper-evident accountability trail for forensic analysis and incident response.
Mitigates:
ML08 Model Skewing
LLM10 Unbounded Consumption
LLM06 Excessive Agency
ASI08 Cascading Failures
ASI10 Rogue Agents
2.3.2 Anomaly Detection – Mandate the implementation of advanced monitoring to detect unusual patterns in AI system behaviour. This includes, but is not limited to, accessing systems at unusual times, abnormal transaction volumes, deviations in model performance or resource consumption, or attempts to access unauthorized data. Such anomalies must trigger automated alerts for security review.
Mitigates:
ML08 Model Skewing
LLM10 Unbounded Consumption
ASI02 Tool Misuse and Exploitation
ASI10 Rogue Agents
2.3.3 Human Verification for Critical Actions – Mandate that any actions by an AI system that may cause serious/critical potential harm (severity of harm or frequency & number of users impacted), is autonomous and irreversible, or where failure may disrupt essential operations or safety, requires explicit confirmation from a human operator. Examples include financial transactions above a certain threshold, the permanent deletion of data, or modifications to critical system configurations. This "human-in-the-loop" control is an essential safety check against autonomous errors.
Mitigates:
LLM01 Prompt Injection
LLM06 Excessive Agency
ASI01 Agent Goal Hijack
ASI02 Tool Misuse and Exploitation
ASI09 Human-Agent Trust Exploitation
MCP04 Tool Interference
2.3.4 Mitigation of Misinformation and Hallucination – Mandate that AI system outputs for action-oriented tasks must be grounded in verified, trusted data sources using techniques like Retrieval-Augmented Generation (RAG). For critical decisions, a mechanism must be in place to cross-reference generated information against reliable sources before the agent is permitted to execute an action based on that information.
Mitigates:
LLM09 Misinformation
LLM08 Vector and Embedding Weaknesses
ASI08 Cascading Failures
ASI09 Human-Agent Trust Exploitation
2.3.5 Secure Input and Goal Management – Mandate the implementation of layered input filtering, including both syntactic and semantic analysis, to detect and neutralize prompt injection, jailbreaking attempts, or other malicious inputs designed to manipulate an agent's goals. Any significant modification of an AI system’s primary, system-level goals must require explicit human approval.
Mitigates:
ML01 Input Manipulation Attack
LLM01 Prompt Injection
ASI01 Agent Goal Hijack
MCP02 Prompt Injection
2.3.6 UI Transparency and Manifest Validation – Mandate that AI interfaces must display the full tool manifest (not a shortened summary) to the user before activation. Automated scanners (e.g. MCP-scan) must be integrated to inspect tool descriptions for hidden instructions or malicious keywords
Mitigates:
MCP01 Tool Poisoning & Rug Pull Attack
2.3.7 UI/UX Behavioural Safeguards and Trust Calibration – Mandate that AI interfaces provide plain-language risk summaries and confidence-weighted cues (e.g. "low-certainty") rather than relying on model-generated rationales. High-risk recommendations must be visually differentiated (e.g. red borders, clear banners etc.). Persuasive or emotionally manipulative language must be stripped from safety-critical flows to reduce automation bias (e.g. through neutral prompt engineering, stripping of emotional anchors and standardized response formats, etc).
Mitigates:
ASI09 Human-Agent Trust Exploitation
2.4 Pillar IV: Building for Resilience and Containment
2.4.1 Resource Consumption Limits – Mandate the implementation of strict resource quotas (CPU, memory, time) with early alerts and rate limiting for all AI systems and their users. These controls are critical to prevent resource exhaustion, whether caused by a malicious denial-of-service attack or an unintentional recursive loop, and to control operational costs.
Mitigates:
LLM10 Unbounded Consumption
ASI02 Tool Misuse and Exploitation
MCP04 Tool Interference
2.4.2 Secure Output Handling – Mandate that all outputs from an AI model must be treated as untrusted input before being passed to downstream components. Outputs must be strictly validated, sanitized, and properly encoded for the context in which they will be used. This prevents vulnerabilities such as Cross-Site Scripting (XSS), SQL injection, or Remote Code Execution (RCE) initiated by a manipulated model response.
Mitigates:
ML09 Output Integrity Attack
LLM05 Improper Output Handling
ASI05 Unexpected Code Execution (RCE)
MCP01 Tool Poisoning & Rug Pull Attack
2.4.3 Prevention of Unintended Consequences – Mandate the establishment of explicit, hard-coded operational boundaries and automated "circuit breakers" for all autonomous agents. These mechanisms must automatically halt an agent's operations if key performance indicators for the broader system fall below a predefined safe threshold, preventing a locally optimal agent decision from causing systemic harm.
Mitigates:
LLM06 Excessive Agency
ASI08 Cascading Failures
ASI10 Rogue Agents
2.4.4 Secure Inter-Agent Communication – In multi-agent systems, mandate that all communication between agents must be encrypted and mutually authenticated. Each agent must be able to securely verify the identity of any other agent it interacts with to prevent message spoofing, eavesdropping, and systemic manipulation by a compromised agent.
Mitigates:
ASI07 Insecure Inter-Agent Communication
2.4.5 Context Isolation and Memory TTL – Mandate the resetting of LLM context between distinct tool executions to prevent cross-contamination. For systems utilizing long-term memory, implement a strict Time-To-Live (TTL) on stored data and isolate memory partitions by individual user session
Mitigates:
ASI03 Identity and Privilege Abuse
ASI06 Memory & Context Poisoning
MCP03 Memory Poisoning
MCP04 Tool Interference
2.4.6 Identity and Behavioural Attestation – Mandate the implementation of per-agent cryptographic identification including an attached signed behavioural manifest declaring expected capabilities, tools and goals, and the use of "Watchdog Agents" as a behavioural verification layer to monitor peer-agent behaviour for collusion, optimisation abuse (reward hacking), and deviations from declared behavioural manifests (e.g. unapproved tool invocations, unexpected data exfiltration attempts etc).
Mitigates:
ASI10: Rogue Agents
2.4.7: Restricted Execution and Function Banning – For AI agentic systems capable of real-time code generation and execution, including tasks such as "vibe coding" or autonomous self-repair, prohibit the use of high-risk functions such as eval(), unsafe deserialization, or direct shell command in production environments, and require the use of safe interpreters with built-in taint-tracking to ensure attacker-influenced data cannot reach sensitive execution sinks.
Mitigates:
ASI05 Unexpected Code Execution (RCE)
ASI10: Rogue Agents`;

            const mandatesContainer = document.getElementById("codex-mandates-sections");
            const filterInput = document.getElementById("codex-filter-input");
            const filterButtons = Array.from(document.querySelectorAll(".codex-filter-btn"));
            const mandatesCountEl = document.getElementById("codex-mandates-count");
            const lastSyncEl = document.getElementById("codex-last-sync");
            const frameworkCountEl = document.getElementById("codex-framework-count");
            const frameworkListEl = document.getElementById("codex-framework-list");
            const libraryListEl = document.getElementById("codex-library-list");
            const selectedFrameworkEl = document.getElementById("codex-selected-framework");

            let activeFilter = "all";
            let mandates = [];
            let scopedMandates = [];
            let pillars = {};
            let activePillarGroups = new Set();

            function sortPillarEntries(pillarMap) {
                return Object.entries(pillarMap).sort((a, b) => a[0].localeCompare(b[0], undefined, { numeric: true }));
            }

            function scoreRisk(risk) {
                if (/rce|code execution|privilege|poison|hijack|prompt injection|supply chain|exfiltration|rogue/i.test(risk)) {
                    return 3;
                }
                if (/leak|disclosure|misinformation|inversion|inference|theft|misuse|interference|consumption/i.test(risk)) {
                    return 2;
                }
                return 1;
            }

            function getRiskLevel(risks) {
                const peak = Math.max(1, ...risks.map(scoreRisk));
                if (peak >= 3) {
                    return "critical";
                }
                if (peak >= 2) {
                    return "high";
                }
                return "medium";
            }

            function cleanLine(line) {
                return line.replace(/\s+/g, " ").trim();
            }

            function parseFromLines(lines) {
                const parsedPillars = {};

                lines.forEach((line) => {
                    const pillarMatch = line.match(/^2\.(\d+)\s+Pillar\s+[IVX]+:\s+(.+)$/i);
                    if (pillarMatch) {
                        parsedPillars["2." + pillarMatch[1]] = pillarMatch[2].trim();
                    }
                });

                const parsedMandates = [];
                let current = null;
                let mode = "summary";

                function pushCurrent() {
                    if (!current) {
                        return;
                    }
                    current.summary = current.summaryLines.join(" ").trim() || "No additional mandate narrative provided.";
                    current.risks = Array.from(new Set(current.risks));
                    current.riskLevel = getRiskLevel(current.risks);
                    current.pillar = parsedPillars[current.group] || "Core Security Mandates";
                    current.searchText = (current.code + " " + current.title + " " + current.summary + " " + current.risks.join(" ")).toLowerCase();
                    parsedMandates.push(current);
                    current = null;
                    mode = "summary";
                }

                for (const rawLine of lines) {
                    const line = cleanLine(rawLine);
                    if (!line) {
                        continue;
                    }

                    const mandateMatch = line.match(/^(2\.\d+\.\d+):?\s+(.+)$/);
                    if (mandateMatch) {
                        pushCurrent();
                        const code = mandateMatch[1];
                        const body = mandateMatch[2];
                        const parts = body.split(/\s+[–-]\s+/);
                        const title = cleanLine(parts[0] || "Untitled Mandate");
                        const opening = cleanLine((parts.slice(1).join(" - ") || "")
                            .replace(/^Mandate\s+(that|the|to)\s+/i, "")
                            .replace(/^Mandate\s*/i, ""));
                        current = {
                            code: code,
                            title: title,
                            group: code.split(".").slice(0, 2).join("."),
                            summaryLines: opening ? [opening] : [],
                            risks: []
                        };
                        mode = "summary";
                        continue;
                    }

                    if (!current) {
                        continue;
                    }

                    if (/^Mitigates\s*:?\s*$/i.test(line)) {
                        mode = "risks";
                        continue;
                    }

                    if (/^2\.\d+\s+Pillar\s+/i.test(line) || /^3\.0\b/i.test(line) || /^Appendix\b/i.test(line)) {
                        pushCurrent();
                        continue;
                    }

                    if (mode === "risks") {
                        line
                            .split(/(?=\b[A-Z]{2,4}\d{2}:?\s)/g)
                            .map(cleanLine)
                            .filter(Boolean)
                            .forEach((riskItem) => current.risks.push(riskItem));
                    } else {
                        current.summaryLines.push(line);
                    }
                }

                pushCurrent();

                return {
                    mandates: parsedMandates,
                    pillars: parsedPillars
                };
            }

            function extractParagraphLines(xmlText) {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, "application/xml");
                return Array.from(xmlDoc.getElementsByTagNameNS("*", "p"))
                    .map((p) => Array.from(p.getElementsByTagNameNS("*", "t")).map((node) => node.textContent || "").join(""))
                    .map(cleanLine)
                    .filter(Boolean);
            }

            async function loadFromDocx() {
                if (!window.JSZip) {
                    throw new Error("JSZip unavailable");
                }
                const response = await fetch(DOCX_PATH);
                if (!response.ok) {
                    throw new Error("Unable to fetch policy docx");
                }
                const zipData = await response.arrayBuffer();
                const zip = await window.JSZip.loadAsync(zipData);
                const docXml = await zip.file("word/document.xml").async("string");
                const lines = extractParagraphLines(docXml);
                return parseFromLines(lines);
            }

            function buildPillarList(pillarMap) {
                const ordered = sortPillarEntries(pillarMap);
                frameworkCountEl.textContent = String(ordered.length).padStart(2, "0");
                frameworkListEl.innerHTML = ordered.map((entry) => {
                    const label = entry[1];
                    return `
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="w-1.5 h-1.5 bg-primary rounded-full shadow-glow"></div>
                                <span class="text-xs font-mono text-white">${label}</span>
                            </div>
                            <span class="text-[10px] text-text-muted font-mono">ACTIVE</span>
                        </div>`;
                }).join("");
            }

            function buildLibraryTree(pillarMap) {
                const ordered = sortPillarEntries(pillarMap);
                const pills = ordered.map((entry) => {
                    const group = entry[0];
                    const title = entry[1];
                    const mandateCount = mandates.filter((mandate) => mandate.group === group).length;
                    const isActive = activePillarGroups.has(group);
                    const itemClass = isActive
                        ? "bg-primary/10 text-primary border border-primary/40"
                        : "bg-background-dark text-text-muted border border-border-dark hover:text-white hover:border-primary/40";
                    const icon = isActive ? "check_box" : "check_box_outline_blank";
                    return `
                        <button class="w-full text-left px-4 py-3 transition-all ${itemClass}" type="button" data-library-group="${group}" aria-pressed="${isActive}">
                            <div class="flex items-center justify-between gap-3">
                                <div class="flex items-center gap-2 min-w-0">
                                    <span class="material-symbols-outlined text-[16px]">${icon}</span>
                                    <span class="text-[11px] font-mono truncate">${group} ${title}</span>
                                </div>
                                <span class="text-[10px] font-mono">${mandateCount}</span>
                            </div>
                        </button>`;
                }).join("");

                libraryListEl.innerHTML = `
                    <div class="text-[10px] text-text-muted font-mono px-2 py-1 tracking-widest">PILLAR_SCOPE (MULTI_SELECT)</div>
                    <div class="space-y-1">${pills}</div>
                `;
            }

            function levelBadgeClass(level) {
                if (level === "critical") {
                    return "bg-critical/20 text-critical border border-critical/30";
                }
                if (level === "high") {
                    return "bg-warning/20 text-warning border border-warning/30";
                }
                return "bg-primary/20 text-primary border border-primary/30";
            }

            function levelStripeClass(level) {
                if (level === "critical") {
                    return "bg-critical";
                }
                if (level === "high") {
                    return "bg-warning";
                }
                return "bg-primary";
            }

            function levelText(level) {
                if (level === "critical") {
                    return "CRITICAL_RISK";
                }
                if (level === "high") {
                    return "HIGH_RISK";
                }
                return "MODERATE_RISK";
            }

            function renderMandates(items, pillarMap) {
                if (!items.length) {
                    mandatesContainer.innerHTML = `<div class="border border-critical/40 bg-critical/10 p-5 font-mono text-xs text-critical">NO_MANDATES_FOUND_IN_SELECTED_PILLARS.</div>`;
                    return;
                }

                const groups = {};
                items.forEach((mandate) => {
                    if (!groups[mandate.group]) {
                        groups[mandate.group] = [];
                    }
                    groups[mandate.group].push(mandate);
                });

                const groupKeys = Object.keys(groups).sort((a, b) => a.localeCompare(b, undefined, { numeric: true }));
                let html = "";

                groupKeys.forEach((groupKey, groupIndex) => {
                    const title = (pillarMap[groupKey] || "Core Security Mandates").toUpperCase();
                    html += `
                        <div class="flex items-center gap-4 py-4 ${groupIndex === 0 ? "mt-2" : "mt-8"}">
                            <span class="text-primary font-mono font-bold text-lg">${groupKey} // ${title}</span>
                            <div class="h-px bg-border-dark flex-1"></div>
                        </div>`;

                    groups[groupKey].forEach((mandate) => {
                        const risksHtml = mandate.risks.length
                            ? mandate.risks.map((risk) => `<li class="text-xs text-text-main font-mono">${risk}</li>`).join("")
                            : `<li class="text-xs text-text-muted font-mono">No mapped threat references.</li>`;

                        html += `
                            <article class="border border-border-dark bg-surface-dark relative group transition-all mandate-card" data-level="${mandate.riskLevel}" data-search="${mandate.searchText}">
                                <div class="absolute top-0 bottom-0 left-0 w-1 ${levelStripeClass(mandate.riskLevel)}"></div>
                                <div class="p-5 flex flex-col md:flex-row md:items-center justify-between gap-4">
                                    <div class="flex items-start md:items-center gap-5">
                                        <button class="mandate-toggle border border-border-dark size-6 flex items-center justify-center text-text-muted hover:text-white hover:border-white transition-all bg-background-dark" type="button" aria-expanded="false">
                                            <span class="material-symbols-outlined text-base">add</span>
                                        </button>
                                        <div>
                                            <div class="flex items-center gap-3 mb-1">
                                                <span class="font-mono text-primary font-bold text-sm">${mandate.code}</span>
                                                <span class="${levelBadgeClass(mandate.riskLevel)} text-[10px] px-1.5 py-0.5 font-bold font-mono">${levelText(mandate.riskLevel)}</span>
                                            </div>
                                            <h4 class="text-white font-bold text-lg tracking-wide font-display">${mandate.title}</h4>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-6 pr-2">
                                        <div class="text-right hidden sm:block">
                                            <div class="text-[10px] text-text-muted font-mono">MANDATE_GROUP</div>
                                            <div class="text-xs text-white font-mono">${mandate.group}</div>
                                        </div>
                                        <div class="size-3 rounded-full ${levelStripeClass(mandate.riskLevel)} opacity-90"></div>
                                    </div>
                                </div>
                                <div class="mandate-body hidden px-5 pb-5 pl-[4.25rem] pr-8 border-t border-border-dark/50 pt-5 bg-black/30">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                                        <div class="md:col-span-2 space-y-4">
                                            <p class="text-text-main text-sm leading-relaxed font-mono opacity-90">${mandate.summary}</p>
                                            <div class="bg-background-dark border border-border-dark p-3">
                                                <div class="flex items-center justify-between mb-2 border-b border-border-dark pb-2">
                                                    <span class="text-[10px] text-text-muted font-bold tracking-wider font-mono">MITIGATES</span>
                                                    <span class="text-[10px] text-primary font-mono font-bold">${mandate.risks.length} RISK_REFERENCES</span>
                                                </div>
                                                <ul class="space-y-1">${risksHtml}</ul>
                                            </div>
                                        </div>
                                        <div class="md:col-span-1 border-l border-border-dark pl-6 flex flex-col gap-4">
                                            <div>
                                                <span class="text-[10px] text-text-muted font-bold block mb-1 font-mono">CATEGORY</span>
                                                <span class="text-sm text-white font-mono">${mandate.pillar}</span>
                                            </div>
                                            <div>
                                                <span class="text-[10px] text-text-muted font-bold block mb-1 font-mono">RISK_LEVEL</span>
                                                <span class="text-sm text-white font-mono">${levelText(mandate.riskLevel)}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </article>`;
                    });
                });

                mandatesContainer.innerHTML = html;

                mandatesContainer.querySelectorAll(".mandate-toggle").forEach((toggleButton) => {
                    toggleButton.addEventListener("click", function () {
                        const card = this.closest(".mandate-card");
                        const body = card.querySelector(".mandate-body");
                        const icon = this.querySelector(".material-symbols-outlined");
                        const isOpen = !body.classList.contains("hidden");
                        body.classList.toggle("hidden", isOpen);
                        this.setAttribute("aria-expanded", String(!isOpen));
                        icon.textContent = isOpen ? "add" : "remove";
                    });
                });
            }

            function renderCurrentScope() {
                scopedMandates = mandates.filter((mandate) => activePillarGroups.has(mandate.group));

                renderMandates(scopedMandates, pillars);
                if (activePillarGroups.size === 0) {
                    selectedFrameworkEl.textContent = "NO_PILLARS_SELECTED";
                } else if (activePillarGroups.size === 1) {
                    const group = Array.from(activePillarGroups)[0];
                    const label = pillars[group] || group;
                    selectedFrameworkEl.textContent = `${group} ${label}`.toUpperCase();
                } else {
                    selectedFrameworkEl.textContent = `${activePillarGroups.size} PILLARS SELECTED`;
                }
                applyFilters();
            }

            function togglePillarGroup(nextGroup) {
                if (activePillarGroups.has(nextGroup) && activePillarGroups.size > 1) {
                    activePillarGroups.delete(nextGroup);
                } else {
                    activePillarGroups.add(nextGroup);
                }
                buildLibraryTree(pillars);
                renderCurrentScope();
            }

            function applyFilters() {
                const query = (filterInput.value || "").trim().toLowerCase();
                const cards = Array.from(document.querySelectorAll(".mandate-card"));
                let visibleCount = 0;

                cards.forEach((card) => {
                    const matchesSearch = !query || card.dataset.search.includes(query);
                    const matchesRisk = activeFilter === "all" || card.dataset.level === activeFilter;
                    const show = matchesSearch && matchesRisk;
                    card.classList.toggle("hidden", !show);
                    if (show) {
                        visibleCount += 1;
                    }
                });

                mandatesCountEl.textContent = `${visibleCount}/${scopedMandates.length} MANDATES`;
            }

            function setActiveFilter(nextFilter) {
                activeFilter = nextFilter;
                filterButtons.forEach((button) => {
                    const isActive = button.dataset.filter === nextFilter;
                    button.classList.toggle("bg-surface-dark", isActive);
                    button.classList.toggle("border-primary", isActive);
                    button.classList.toggle("text-primary", isActive);
                    button.classList.toggle("bg-background-dark", !isActive);
                    button.classList.toggle("border-border-dark", !isActive);
                    button.classList.toggle("text-text-muted", !isActive);
                });
                applyFilters();
            }

            filterButtons.forEach((button) => {
                button.addEventListener("click", () => setActiveFilter(button.dataset.filter));
            });
            filterInput.addEventListener("input", applyFilters);
            libraryListEl.addEventListener("click", function (event) {
                const trigger = event.target.closest("[data-library-group]");
                if (!trigger) {
                    return;
                }
                togglePillarGroup(trigger.dataset.libraryGroup);
            });

            (async function init() {
                let parsed;
                try {
                    parsed = await loadFromDocx();
                    lastSyncEl.textContent = `LIVE // ${new Date().toISOString().replace("T", " ").slice(0, 19)} UTC`;
                } catch (error) {
                    const fallbackLines = FALLBACK_POLICY_TEXT.split("\n").map(cleanLine).filter(Boolean);
                    parsed = parseFromLines(fallbackLines);
                    lastSyncEl.textContent = "FALLBACK_SNAPSHOT";
                }

                mandates = parsed.mandates;
                pillars = parsed.pillars;
                buildPillarList(pillars);
                const orderedPillars = sortPillarEntries(pillars).map((entry) => entry[0]);
                activePillarGroups = new Set(orderedPillars);
                buildLibraryTree(pillars);
                renderCurrentScope();
                setActiveFilter("all");
            }());
        }());
    </script>
<script>
        (function () {
            const CONTEXT_KEY = "neon_guardian_scan_context_v1";
            const repoEl = document.getElementById("codex-header-repo");
            const sessionEl = document.getElementById("codex-session-id");

            if (!repoEl || !sessionEl) {
                return;
            }

            function normalizeRepoName(value) {
                if (!value) {
                    return "";
                }
                const text = String(value).trim();
                const parts = text.split(":");
                const candidate = parts.length > 1 ? parts.slice(1).join(":") : text;
                return candidate.trim().replace(/\s+/g, "-");
            }

            function generateSessionId(repo) {
                const repoToken = normalizeRepoName(repo).replace(/[^a-zA-Z0-9]/g, "").slice(0, 4).toUpperCase() || "SCAN";
                const timestamp = Date.now().toString(36).toUpperCase().slice(-6);
                const nonce = Math.random().toString(36).slice(2, 6).toUpperCase();
                return "NG-" + repoToken + "-" + timestamp + nonce;
            }

            function loadContext() {
                try {
                    const raw = localStorage.getItem(CONTEXT_KEY);
                    const parsed = raw ? JSON.parse(raw) : null;
                    return parsed && typeof parsed === "object" ? parsed : {};
                } catch (_error) {
                    return {};
                }
            }

            function saveContext(context) {
                try {
                    localStorage.setItem(CONTEXT_KEY, JSON.stringify(context));
                } catch (_error) {
                    // Ignore storage errors.
                }
            }

            function syncFromContext(onlyRead) {
                const context = loadContext();
                const repo = normalizeRepoName(context.repo || repoEl.textContent || "unknown-repo");
                const sessionId = context.sessionId || generateSessionId(repo);

                repoEl.textContent = repo;
                sessionEl.textContent = sessionId;

                if (!onlyRead) {
                    saveContext({
                        repo: repo,
                        sessionId: sessionId,
                        updatedAt: new Date().toISOString()
                    });
                }
            }

            syncFromContext(false);
            window.addEventListener("storage", function (event) {
                if (event.key === CONTEXT_KEY) {
                    syncFromContext(true);
                }
            });
        }());
    </script>
<script defer="" src="../../assets/live-data.js"></script>
</body></html>
